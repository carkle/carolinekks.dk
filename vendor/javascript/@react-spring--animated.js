// @react-spring/animated@10.0.0 downloaded from https://ga.jspm.io/npm:@react-spring/animated@10.0.0/dist/react-spring_animated.modern.mjs

import{defineHidden as t,is as e,createInterpolator as r,eachProp as s,hasFluidValue as n,getFluidValue as a,each as i,isAnimatedString as u,useForceUpdate as o,useIsomorphicLayoutEffect as l,addFluidObserver as c,removeFluidObserver as d,raf as h,useOnce as p}from"@react-spring/shared";import*as m from"react";import{forwardRef as y,useRef as g,useCallback as f,useEffect as v}from"react";var _=Symbol.for("Animated:node");var V=t=>!!t&&t[_]===t;var A=t=>t&&t[_];var P=(e,r)=>t(e,_,r);var S=t=>t&&t[_]&&t[_].getPayload();var w=class{constructor(){P(this,this)}getPayload(){return this.payload||[]}};var x=class _AnimatedValue extends w{constructor(t){super();this._value=t;this.done=true;this.durationProgress=0;e.num(this._value)&&(this.lastPosition=this._value)}static create(t){return new _AnimatedValue(t)}getPayload(){return[this]}getValue(){return this._value}setValue(t,r){if(e.num(t)){this.lastPosition=t;if(r){t=Math.round(t/r)*r;this.done&&(this.lastPosition=t)}}if(this._value===t)return false;this._value=t;return true}reset(){const{done:t}=this;this.done=false;if(e.num(this._value)){this.elapsedTime=0;this.durationProgress=0;this.lastPosition=this._value;t&&(this.lastVelocity=null);this.v0=null}}};var C=class _AnimatedString extends x{constructor(t){super(0);this._string=null;this._toString=r({output:[t,t]})}static create(t){return new _AnimatedString(t)}getValue(){const t=this._string;return t==null?this._string=this._toString(this._value):t}setValue(t){if(e.str(t)){if(t==this._string)return false;this._string=t;this._value=1}else{if(!super.setValue(t))return false;this._string=null}return true}reset(t){t&&(this._toString=r({output:[this.getValue(),t]}));this._value=0;super.reset()}};var b={dependencies:null};var N=class extends w{constructor(t){super();this.source=t;this.setValue(t)}getValue(t){const e={};s(this.source,((r,s)=>{V(r)?e[s]=r.getValue(t):n(r)?e[s]=a(r):t||(e[s]=r)}));return e}setValue(t){this.source=t;this.payload=this._makePayload(t)}reset(){this.payload&&i(this.payload,(t=>t.reset()))}_makePayload(t){if(t){const e=new Set;s(t,this._addToPayload,e);return Array.from(e)}}_addToPayload(t){b.dependencies&&n(t)&&b.dependencies.add(t);const e=S(t);e&&i(e,(t=>this.add(t)))}};var T=class _AnimatedArray extends N{constructor(t){super(t)}static create(t){return new _AnimatedArray(t)}getValue(){return this.source.map((t=>t.getValue()))}setValue(t){const e=this.getPayload();if(t.length==e.length)return e.map(((e,r)=>e.setValue(t[r]))).some(Boolean);super.setValue(t.map(k));return true}};function k(t){const e=u(t)?C:x;return e.create(t)}function B(t){const r=A(t);return r?r.constructor:e.arr(t)?T:u(t)?C:x}var E=(t,r)=>{const s=!e.fun(t)||t.prototype&&t.prototype.isReactComponent;return y(((e,n)=>{const a=g(null);const u=s&&f((t=>{a.current=R(n,t)}),[n]);const[y,_]=O(e,r);const V=o();const A=()=>{const t=a.current;if(s&&!t)return;const e=!!t&&r.applyAnimatedValues(t,y.getValue(true));e===false&&V()};const P=new M(A,_);const S=g(void 0);l((()=>{S.current=P;i(_,(t=>c(t,P)));return()=>{if(S.current){i(S.current.deps,(t=>d(t,S.current)));h.cancel(S.current.update)}}}));v(A,[]);p((()=>()=>{const t=S.current;i(t.deps,(e=>d(e,t)))}));const w=r.getComponentProps(y.getValue());return m.createElement(t,{...w,ref:u})}))};var M=class{constructor(t,e){this.update=t;this.deps=e}eventObserved(t){t.type=="change"&&h.write(this.update)}};function O(t,e){const r=new Set;b.dependencies=r;t.style&&(t={...t,style:e.createAnimatedStyle(t.style)});t=new N(t);b.dependencies=null;return[t,r]}function R(t,r){t&&(e.fun(t)?t(r):t.current=r);return r}var $=Symbol.for("AnimatedComponent");var j=(t,{applyAnimatedValues:r=()=>false,createAnimatedStyle:n=t=>new N(t),getComponentProps:a=t=>t}={})=>{const i={applyAnimatedValues:r,createAnimatedStyle:n,getComponentProps:a};const u=t=>{const r=q(t)||"Anonymous";t=e.str(t)?u[t]||(u[t]=E(t,i)):t[$]||(t[$]=E(t,i));t.displayName=`Animated(${r})`;return t};s(t,((r,s)=>{e.arr(t)&&(s=q(r));u[s]=u(r)}));return{animated:u}};var q=t=>e.str(t)?t:t&&e.str(t.displayName)?t.displayName:e.fun(t)&&t.name||null;export{w as Animated,T as AnimatedArray,N as AnimatedObject,C as AnimatedString,x as AnimatedValue,j as createHost,A as getAnimated,B as getAnimatedType,S as getPayload,V as isAnimated,P as setAnimated};

